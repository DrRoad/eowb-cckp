#eowb-cckp

Applications to enhance the [World Bank CCKP Portal](http://sdwebx.worldbank.org/climateportal/index.cfm) by integration of European EO-based datasets

##ReoWBcckp R package

ReoWBcckp is an R package to:

* Ease the access to OGC Web Coverage Service data 
* Access a country Exclusive Economic Zone (EEZ) spatial envelope
* Access Exclusive Economic Zone (EEZ) spatial data using the country ISO code

By putting those features together, extracting the European Space Agency (ESA) Climate Change Initiative data for a given country becomes straightforward.

The example code below show the Sea Level Anomaly mean value for august 2010.

```coffee
library(devtools)
library(raster)
install_github("eowb-cckp", username="Terradue", subdir="/src/main/R/ReoWBcckp", ref="master")
library("ReoWBcckp")

# work with Portugal
country.code <- "PRT"

# get the template for the WCS request and fill it with values
wcs.template <- GetWCSTemplate()

# and fill the template with values
wcs.template$value[wcs.template$param == "service"] <- "WCS" 
wcs.template$value[wcs.template$param == "version"] <- "1.0.0"
wcs.template$value[wcs.template$param == "request"] <- "GetCoverage"
wcs.template$value[wcs.template$param == "coverage"] <- "sla"
wcs.template$value[wcs.template$param == "format"] <- "NetCDF3"

# reduce the Sea Level Anomaly coverage area to the country EEZ spatial envelope
wcs.template$value[wcs.template$param == "bbox"] <- GetCountryEnvelope(country.code)

# get the coverage
r <- GetWCSCoverage("http://catalogue.eowb-cckp.terradue.int/thredds/wcs/SeaLevel-ECV/V1.1_20131220/ESACCI-SEALEVEL-L4-MSLA-MERGED-20100815000000-fv01.nc", 
  wcs.template, by.ref=FALSE)

# shift it to a reference system of -180,-90,180,90
ra <- shift(r, x=-360,y=0)

# apply a vector mask with Portugal EEZ
r.mask <- mask(ra, GetCountryEEZ(country.code))

# plot the mask
plot(r.mask)

# add the portuguese EEZ
plot(GetCountryEEZ(country.code), add=TRUE)

# get the mean SLA value
prt_mean_sla <- cellStats(r.mask, 'mean')
```

The image generated by the code above is shown below.

![alt text](prt.png)

The data used in the example has been downloaded from http://www.esa-sealevel-cci.org and exposed as an OGC WCS Coverage using [THREDDS](http://www.unidata.ucar.edu/software/thredds/current/tds/).


## Questions, bugs, and suggestions

Please file any bugs or questions as [issues](https://github.com/Terradue/eowb-cckp/issues/new) or send in a pull request.
